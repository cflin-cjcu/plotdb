{"theme":null,"data":[],"type":{"location":"server","name":"chart"},"owner":"o3tgs6","key":"1qnsca1","permission":{"switch":["public"],"value":[{"switch":"public","perm":"fork"}]},"name":"Glued Bubbles","desc":"sticky pasty bubbles","tags":[""],"doc":{"name":"document","type":"html","content":"<h3>D3.js Pack Layout Example</h3>","lines":1,"size":34},"style":{"name":"stylesheet","type":"css","content":" \nsvg, body {\n  background: #fff;\n}\nsvg, body, text {\n  font-family: arial;\n  color: #222;\n  fill: #222;\n  font-size: 12px;\n}\ntext {\n  text-anchor: middle;\n  dominant-baseline: central;\n}\ncircle, rect, path {\n  fill: #eee;\n  stroke: #555;\n  stroke-width: 2;\n}\nh3 {\n  text-align: center;\n  font-family: Arial;\n}","lines":23,"size":310},"code":{"name":"code","type":"javascript","content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: [\n    {value: 3, name: \"Allen\"},\n    {value: 1, name: \"Bob\"},\n    {value: 4, name: \"Cindy\"},\n    {value: 1, name: \"David\"},\n    {value: 5, name: \"Eva\"},\n    {value: 9, name: \"Frank\"},\n    {value: 2, name: \"Gill\"},\n    {value: 6, name: \"Hilbert\"},\n    {value: 7, name: \"James\"}\n  ],\n  dimension: {\n    value: { type: [plotdb.Number], require: true, desc: \"size of circle\" },\n    name: { type: [], require: false, desc: \"tag of circle\" }\n  },\n  config: {\n    color: { name: \"Color\", type: [plotdb.Color], default: plotdb.Color.default },\n    charge: { name: \"Bubble Charge\", type: [plotdb.Number], default: 100 },\n    gravity: { name: \"Chart Gravity\", type: [plotdb.Number], default: 1 },\n    friction: { name: \"Chart Friction\", type: [plotdb.Number], default: 0.9 }\n  },\n  init: function() {\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.circleGroup = this.svg.append(\"g\").style({filter: \"url(#glue)\"});\n    this.textGroup = this.svg.append(\"g\");\n    this.defs = this.svg.append(\"defs\");\n    filter = this.defs.append(\"filter\").attr({id: \"glue\", width: 500, height: 500});\n    filter.append(\"feGaussianBlur\").attr({\n      in: \"SourceGraphic\", stdDeviation: 10, result: \"filter\"\n    });\n    filter.append(\"feColorMatrix\").attr({\n      in: \"blur\",\n      mode: \"matrix\",\n      values: \"1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 40 -20\",\n      result: \"filter\"\n    });\n  },\n  bind: function() {\n    this.circles = this.circleGroup.selectAll(\"circle\").data(this.nodes);\n    this.circles.enter().append(\"circle\");\n    this.texts = this.textGroup.selectAll(\"text\").data(this.nodes);\n    this.texts.enter().append(\"text\");\n  },\n  resize: function() {\n    var box = this.root.getBoundingClientRect();\n    var width = box.width;\n    var height = box.height - 100;\n    var that = this;\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.bubble = d3.layout.pack().padding(this.config.padding).size([width,height]);\n    this.nodes = this.bubble.nodes({children: this.data}).filter(function(it) { return it.depth; });\n    if(this.force) this.force.stop();\n    this.force = d3.layout.force().nodes(this.nodes)\n      .size([width, height])\n      .gravity(that.config.gravity)\n      .friction(that.config.friction)\n      .charge(function(it) { return -1 * that.config.charge * it.r * it.r / 10;});\n    this.force.on(\"tick\", function(it) { that.tick(); });\n    this.force.start();\n  },\n  tick: function() {\n    this.render();\n  },\n  render: function() {\n    var that = this;\n    this.circles.attr({\n      cx: function(it) { return it.x; },\n      cy: function(it) { return it.y; },\n      r:  function(it) { return it.r; }\n    }).style({\n      fill: that.config.color,\n      stroke: \"none\",\n      filter: \"url(#glue)\"\n    });\n    this.texts.attr({\n      x: function(it) { return it.x; },\n      y: function(it) { return it.y; },\n    }).style({\n      fill: function(it) {\n        var hsl = d3.hsl(that.config.color);\n        if(hsl.l > 0.65) return \"#000\"; else return \"#fff\";\n      }\n    }).text(function(it) { return it.name; });\n  }\n});","lines":91,"size":3209},"config":{"color":{"name":"Color","type":[{"name":"Color","level":4,"default":"#dc4521"}],"default":"#dc4521","value":"#e03309"},"charge":{"name":"Bubble Charge","type":[{"name":"Number","level":3}],"default":100,"value":"100"},"gravity":{"name":"Chart Gravity","type":[{"name":"Number","level":3}],"default":1,"value":"0.9"},"friction":{"name":"Chart Friction","type":[{"name":"Number","level":3}],"default":0.9,"value":"0.1"}},"dimension":{"value":{"type":[{"name":"Number","level":3}],"require":true,"desc":"size of circle","fields":[]},"name":{"type":[],"require":false,"desc":"tag of circle","fields":[]}},"assets":[],"isType":false,"createdTime":1455853202274,"modifiedTime":1458279070125,"ownerName":"Kirby Wu","likes":0,"parent":null,"basetype":"5","visualencoding":["6"],"category":["99"]}