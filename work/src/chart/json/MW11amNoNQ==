{"theme":null,"config":{"padding":{"name":"Padding","type":[{"name":"Number","level":3}],"default":10,"rebindOnChange":true,"value":"3"},"palette":{"name":"Palette","type":[{"name":"Palette","level":5,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"}}],"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"hint":"qualitative","value":{"colors":[{"hex":"#7a322a"},{"hex":"#d52c2a"},{"hex":"#f93634"},{"hex":"#dddb83"},{"hex":"#ede6de"},{"hex":"#fdfffa"},{"hex":"#dbdbdb"},{"hex":"#48462d"}]}}},"dimension":{"value":{"type":[{"name":"Number","level":3}],"require":true,"desc":"length of bar"},"name":{"type":[],"require":false,"desc":"tag of bar"}},"data":[],"type":{"location":"server","name":"chart"},"owner":"o3tgs6","key":"1mujch5","permission":{"switch":["public"],"value":[{"switch":"public","perm":"fork"}]},"name":"Curved Bar Chart","desc":"one of the most famous junk chart, yet quite popular in infographics design.","tags":[""],"doc":{"name":"document","type":"html","content":"<h1>Curved Bar Chart</h1>","lines":1,"size":25},"style":{"name":"stylesheet","type":"css","content":"svg, body, text {\n  color: #222;\n  fill: #222;\n  font-size: 12px;\n}\ntext {\n  text-anchor: middle;\n  dominant-baseline: central;\n}\ncircle, rect, path {\n  fill: #eee;\n  stroke: #555;\n  stroke-width: 2;\n}\nh1 {\n  text-align: center;\n  font-family: Arial;\n}","lines":18,"size":252},"code":{"name":"code","type":"javascript","content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: [\n    {value: 3, name: \"Allen\"},\n    {value: 1, name: \"Bob\"},\n    {value: 4, name: \"Cindy\"},\n    {value: 1, name: \"David\"},\n    {value: 5, name: \"Eva\"},\n    {value: 9, name: \"Frank\"},\n    {value: 2, name: \"Gill\"},\n    {value: 6, name: \"Hilbert\"},\n    {value: 7, name: \"James\"}\n  ],\n  dimension: {\n    value: { type: [plotdb.Number], require: true, desc: \"length of bar\" },\n    name: { type: [], require: false, desc: \"tag of bar\" }\n  },\n  config: {\n    padding: { name: \"Padding\", type: [plotdb.Number], default: 10, rebindOnChange: true },\n    palette: { name: \"Palette\", type: [plotdb.Palette], default: plotdb.Palette.default,\n             hint: plotdb.Palette.subtype.qualitative}\n  },\n  init: function() {\n    var that = this;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.barGroup = this.svg.append(\"g\");\n    this.textGroup = this.svg.append(\"g\");\n    this.tickGroup = this.svg.append(\"g\").attr({class: \"axis angle\"});\n    this.values = this.data.map(function(it) { return it.value; });\n    this.tickValues = d3.range(0, 1.0001, 1/9).map(function(it) { return d3.quantile([0,Math.PI*1.5], it); });\n    this.data.sort(function(a,b) {\n      return b.value - a.value;\n    });\n  },\n  bind: function() {\n    this.bars = this.barGroup.selectAll(\"path.bar\").data(this.data)\n      .enter().append(\"path\").attr({class: \"bar\"});\n    this.texts = this.textGroup.selectAll(\"text\").data(this.data)\n      .enter().append(\"text\").text(function(it) { return it.name; });\n    this.ticks = this.tickGroup.selectAll(\"g.tick\").data(this.tickValues)\n      .enter().append(\"g\").attr({class: \"tick\"}).each(function(it) {\n        d3.select(this).append(\"line\");\n        d3.select(this).append(\"text\");\n      });\n  },\n  resize: function() {\n    var box = this.root.getBoundingClientRect();\n    var width = this.width = box.width;\n    var height = this.height = box.height - 100;\n    this.size = ( this.width > this.height ? this.height : this.width ) / 2.2;\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.ascale = d3.scale.linear().domain(d3.extent(this.values)).range([0.05, Math.PI * 1.5]);\n    this.rscale = d3.scale.linear().domain([0, this.data.length]).range([this.size, 0]);\n    this.colors = d3.scale.ordinal()\n      .range(this.config.palette.colors.map(function(it) { return it.hex; }));\n    this.barWidth = this.size / this.data.length - this.config.padding;\n  },\n  render: function() {\n    var that = this;\n    var centerAttr = {\n      transform: [\"translate(\", this.width/2 , \" \", this.height/2, \")\"].join(\"\")\n    };\n    this.barGroup.attr(centerAttr);\n    this.textGroup.attr(centerAttr);\n    this.tickGroup.attr(centerAttr);\n    this.texts.attr({\n      y: function(d,i) { return -(that.rscale(i) - that.barWidth / 2); },\n      x: -this.config.padding\n    }).style({\n      \"text-anchor\": \"end\",\n      \"dominant-baseline\": \"central\",\n      fill: function(it) {\n        var color = that.colors(it.name);\n        var hsl = d3.hsl(color);\n        if(hsl.l > 0.5) return hsl.darker().darker().toString();\n        return color;\n      }\n    });\n    this.bars.attr({\n      d: function(d,i) {\n        var largeArc = (that.ascale(d.value) > Math.PI ? 1 : 0);\n        var r1 = that.rscale(i);\n        var r2 = that.rscale(i) - that.barWidth;\n        var x1 = (Math.sin(0) * r1);\n        var y1 = -(Math.cos(0) * r1);\n        var x2 = (Math.sin(0) * r2);\n        var y2 = -(Math.cos(0) * r2);\n        var x3 = (Math.sin(that.ascale(d.value)) * r1);\n        var y3 = -(Math.cos(that.ascale(d.value)) * r1);\n        var x4 = (Math.sin(that.ascale(d.value)) * r2);\n        var y4 = -(Math.cos(that.ascale(d.value)) * r2);\n        var ret = [\n          \"M\", x1, y1,\n          \"A\", r1, r1, 0, largeArc, 1, x3, y3,\n          \"L\", x4, y4,\n          \"A\", r2, r2, 0, largeArc, 0, x2, y2, \n          \"Z\"\n        ].join(\" \");\n        return ret;\n      }\n    }).style({\n      fill: function(it) { return that.colors(it.name);},\n      stroke: \"none\"\n    });\n    this.tickGroup.selectAll(\"line\").attr({\n      x1: function(it) { return Math.sin(it) * (that.rscale(0) + 1); },\n      y1: function(it) { return -Math.cos(it) * (that.rscale(0) + 1); },\n      x2: function(it) { return Math.sin(it) * (that.rscale(0) + 10); },\n      y2: function(it) { return -Math.cos(it) * (that.rscale(0) + 10); },\n      stroke: \"#000\",\n      \"stroke-width\": 1\n    });\n  }\n});\n","lines":119,"size":4529},"assets":[],"isType":false,"createdTime":1455899778916,"modifiedTime":1458545261766,"ownerName":"Kirby Wu","likes":0,"parent":null,"basetype":"1","visualencoding":["3"],"category":["1"]}