{"theme":null,"basetype":"6","visualencoding":["2","5"],"category":["1","5"],"data":[],"type":{"location":"server","name":"chart"},"owner":"o3tgs6","key":"ptqwmq","permission":{"switch":["public"],"value":[{"switch":"public","perm":"fork"}]},"name":"Radar Chart","desc":"a standard, multiple radar chart","tags":[],"doc":{"name":"document","type":"html","content":"","lines":1,"size":0},"style":{"name":"stylesheet","type":"css","content":"","lines":1,"size":0},"code":{"name":"code","type":"javascript","content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: d3.range(12).map(function(it) {\n    return {\n      radius: d3.range(3).map(function(it) { return Math.random(); }),\n      label: [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"][it]\n    };\n  }),\n  dimension: {\n    radius: { type: [plotdb.Number], require: true, multiple: true, desc: \"radius of point on radar line\" },\n    label: { type: [], desc: \"label of each step ( around radar )\" }\n  },\n  config: {\n    fontSize: { name: \"Font Size\", type: [plotdb.Number], default: 12 },\n    margin: { name: \"Margin\", type: [plotdb.Number], default: 10 },\n    padding: { name: \"Padding\", type: [plotdb.Number], default: 10 },\n    palette: { name: \"Palette\", type: [plotdb.Palette],\n               default: plotdb.Palette.default, hint: plotdb.Palette.subtype.qualitative }\n  },\n  init: function() {\n    var that = this;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.gridgroup = this.svg.append(\"g\").attr({class: \"grid-group\"});\n    this.axisgroupAngle = this.svg.append(\"g\").attr({class: \"axis angle\"});\n    this.labels = this.data.map(function(it) { return it.label ;});\n    this.parsed = d3.transpose(this.data.map(function(it) { return it.radius; }));\n    this.stepcount = (this.parsed[0]?this.parsed[0].length:1);\n    this.radiusRange = d3.extent(this.parsed\n      .map(function(it) { return d3.extent(it); })\n      .reduce(function(a,b) { return a.concat(b); }, []));\n\n  },\n  bind: function() {\n    var that = this;\n    this.svg.selectAll(\"g.data-group\").data(this.parsed)\n      .enter().append(\"g\").attr({class: \"data-group\"}).each(function(d,i) {\n        var node = d3.select(this);\n        node.append(\"path\").attr({class: \"data\"});\n        var update = node.selectAll(\"circle.node\").data(d);\n        update.exit().remove();\n        update.enter().append(\"circle\").attr({class: \"node\"});\n      });\n  },\n  resize: function() {\n    var that = this;\n    var box = this.root.getBoundingClientRect();\n    var width = this.width = box.width;\n    var height = this.height = box.height - 10;\n    var size = (width>height?height:width) - that.config.margin - that.config.fontSize * 5;\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.rscale = d3.scale.linear().domain([0,this.radiusRange[1]]).range([0,size/2]).nice(5);\n    this.niceRRange = this.rscale.domain();\n    this.rticks = this.rscale.ticks(5);\n    var update = this.gridgroup.selectAll(\"circle.grid.radius\").data(this.rticks);\n    update.exit().remove();\n    update.enter().append(\"circle\").attr({class: \"grid radius\"}).sort(d3.descending);\n    this.ascale = d3.scale.linear().domain([0,this.stepcount]).range([0, 2 * Math.PI]);\n    this.aticks = d3.range(this.stepcount);\n    var update = this.gridgroup.selectAll(\"circle.grid.angle\").data(this.aticks);\n    update.exit().remove();\n    update.enter().append(\"line\").attr({class: \"grid angle\"});\n    var update = this.axisgroupAngle.selectAll(\"g\").data(this.aticks);\n    update.exit().remove();\n    update.enter().append(\"g\").attr({class: \"tick\"}).each(function(d,i) {\n      d3.select(this).append(\"text\");\n    });\n    this.line = d3.svg.line().interpolate(\"cardinal\").tension(0.5)\n      .x(function(d,i) { \n        return that.rscale(d) * Math.cos( that.ascale(i) );\n      })\n      .y(function(d,i) { \n        return that.rscale(d) * Math.sin( that.ascale(i) );\n      });\n  },\n  render: function() {\n    var that = this;\n    var center = {\n      transform: function(d,i) {\n        return [\"translate(\",(that.width/2),\",\",(that.height/2),\")\"].join(\"\");\n      }\n    };\n    this.gridgroup.attr(center).selectAll(\"circle.grid.radius\").attr({\n      cx: 0, cy: 0,\n      r: function(d,i) { return that.rscale(d); },\n      fill: \"#ddd\",\n      stroke: \"#fff\",\n      \"stroke-width\": 3\n    });\n    this.axisgroupAngle.attr(center).selectAll(\"text\").attr({\n      \"text-anchor\": \"middle\",\n      \"dominant-baseline\": \"central\",\n      transform: function(d,i) {\n        console.log(i);\n        var x = (that.rscale(that.niceRRange[1]) + 1.5 * that.config.fontSize) * Math.cos( that.ascale(d) );\n        var y = (that.rscale(that.niceRRange[1]) + 1.5 * that.config.fontSize) * Math.sin( that.ascale(d) );\n        return \"translate(\" + (x) + \" \" + (y) + \") rotate(\"+ (360 * (i/that.stepcount) + 90) +\")\";\n      }\n    }).text(function(d,i) { return that.labels[i] || i; });\n    this.gridgroup.selectAll(\"line.grid.angle\").attr({\n      x1: 0, y1: 0,\n      x2: function(d,i) {\n        return that.rscale(that.niceRRange[1]) * Math.cos( that.ascale(d) );\n      },\n      y2: function(d,i) {\n        return that.rscale(that.niceRRange[1]) * Math.sin( that.ascale(d) );\n      },\n      stroke: \"#fff\",\n      \"stroke-width\": 3\n    });\n    this.svg.selectAll(\"g.data-group\").attr(center).each(function(d,idx) {\n      var node = d3.select(this);\n      node.select(\"path.data\").attr({\n        d: function(d,i) { return that.line(d,i) + \"Z\"; },\n        fill: function() {\n          rgb = d3.rgb(that.config.palette.colors[idx % that.config.palette.colors.length].hex);\n          return [\"rgba(\",rgb.r,\",\",rgb.g,\",\",rgb.b,\",\",0.2,\")\"].join(\"\");\n        },\n        stroke: function() {\n          return that.config.palette.colors[idx % that.config.palette.colors.length].hex;\n        },\n        \"stroke-width\": 3\n      });\n      node.selectAll(\"circle.node\").attr({\n        cx: function(d,i) {\n          return that.rscale(d) * Math.cos( that.ascale(i) );\n        },\n        cy: function(d,i) {\n          return that.rscale(d) * Math.sin( that.ascale(i) );\n        },\n        r: 5,\n        fill: \"#fff\",\n        stroke: function(d,i) {\n          return that.config.palette.colors[idx % that.config.palette.colors.length].hex;\n        },\n        \"stroke-width\": 3\n      });\n    });\n  }\n});","lines":143,"size":5882},"config":{"fontSize":{"name":"Font Size","type":[{"name":"Number","level":3}],"default":12,"value":10},"margin":{"name":"Margin","type":[{"name":"Number","level":3}],"default":10,"value":"20"},"padding":{"name":"Padding","type":[{"name":"Number","level":3}],"default":10,"value":10},"palette":{"name":"Palette","type":[{"name":"Palette","level":5,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"}}],"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"hint":"qualitative","value":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]}}},"dimension":{"radius":{"type":[{"name":"Number","level":3}],"require":true,"multiple":true,"desc":"radius of point on radar line"},"label":{"type":[],"desc":"label of each step ( around radar )"}},"assets":[],"isType":false,"likes":0,"parent":null,"createdTime":1458529808314,"ownerName":"Kirby Wu","modifiedTime":1458554520888}