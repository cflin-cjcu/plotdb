var module;module={"export":plotdb.chart.create({name:"bar",title:"Bar Chart",desc:"...",author:"Kirby Wu",sample:[{value:1,text:1,name:"IE"},{value:7,text:7,name:"Chrome"},{value:5,text:5,name:"Firefox"},{value:2,text:2,name:"Opera"},{value:4,text:4,name:"Android"},{value:2,text:2,name:"Safari"},{value:1,text:1,name:"Puffin"}],mapping:{value:{type:[plotdb.Number],require:!0},name:{type:[],require:!1},text:{type:[],require:!1}},config:{padding:{type:[plotdb.Number,plotdb.Percent],"default":10},margin:{type:[plotdb.Number,plotdb.Percent],"default":10},radius:{type:[plotdb.Number],"default":5},palette:{type:[plotdb.Palette],"default":plotdb.Palette["default"]},fontSize:{type:[plotdb.Number],"default":12},direction:{type:[plotdb.Choice(["Vertical","Horizontal"])],"default":"Vertical"},showLabel:{type:[plotdb.Boolean],"default":!0},showAxis:{type:[plotdb.Boolean],"default":!0},axisSize:{type:[plotdb.Number],"default":10}},bind:function(t,e){var i,a,n;return this.svg=d3.select(t).append("svg").attr({width:"100%",height:"100%"}),i=this.svg.selectAll("rect.bar").data(e),i.enter().append("rect").attr({"class":"bar"}),i.exit().remove(),a=this.svg.selectAll("text.name").data(e),a.enter().append("text").attr({"class":"name"}),a.exit().remove(),n=this.svg.selectAll("text.label").data(e),n.enter().append("text").attr({"class":"label"}),n.exit().remove(),this.axisGroup=this.svg.append("g"),this.axisLine=this.axisGroup.append("line")},resize:function(t,e,i){var a,n,r,l,s,o,d,u,h=this;return this.color=d3.scale.ordinal().range(i.palette),a="Vertical"===i.direction,n=i.valueAxis?i.axisSize:0,r=[$(t).width(),$(t).height()],l=r[0],s=r[1],r=[i.margin,i.padding,i.fontSize],o=r[0],d=r[1],u=r[2],this.svg.attr({width:l,height:s,viewBox:"0 0 "+l+" "+s}),this.size=a?[l,s]:[s,l],plotdb.Percent.test(d)&&(d=this.size[0]*(+d.replace(/%/,"")/100)),this.padding=d,this.dim=[[o+(a?n:0),this.size[0]-o-(a?0:n)],[[o,a&&i.showLabel?i.fontSize:0,a?0:5*u].reduce(function(t,e){return t+e},0),this.size[1]-o-(a||!a&&i.showLabel?u:0)]],this.len=[(this.dim[0][1]-this.dim[0][0])/e.length-d,d3.scale.linear().domain([0,d3.max(e.map(function(t){return t.value}))]).range([0,this.dim[1][1]-this.dim[1][0]]),d3.scale.linear().domain([0,d3.max(e.map(function(t){return t.value}))]).range([this.dim[1][1]-this.dim[1][0],0])],this.origin=[function(t,e){return(h.len[0]+d)*e+d/2+(a?n:0)+o},a?function(t){return h.dim[1][1]-h.len[1](t.value)}:this.dim[1][0]],this.axisFunc=d3.svg.axis().orient(a?"left":"bottom").scale(a?this.len[2]:this.len[1]).tickPadding(3).tickSize(0,1)},render:function(t,e,i){var a,n,r,l,s,o,d,u=this;return a="Vertical"===i.direction,n=a?["x","y","width","height","dx","dy"]:["y","x","height","width","dy","dx"],r=this.svg.selectAll("rect.bar"),r.attr((l={},l[n[0]+""]=this.origin[0],l[n[1]+""]=this.origin[1],l[n[2]+""]=this.len[0],l[n[3]+""]=function(t){return u.len[1](t.value)},l.rx=i.radius,l.ry=i.radius,l.fill=function(t,e){return u.color(e)},l.stroke="none",l)),s=this.svg.selectAll("text.name"),s.attr((l={},l[n[0]+""]=this.origin[0],l[n[1]+""]=this.origin[1],l[n[4]+""]=function(){return u.len[0]/2},l[n[5]+""]=function(t){return a?u.len[1](t.value)+i.fontSize:-i.fontSize},l["font-size"]=i.fontSize,l["text-anchor"]=a?"middle":"end",l["dominant-baseline"]="central",l)),s.text(function(t){return t.name}),o=this.svg.selectAll("text.label"),o.attr((l={},l[n[0]+""]=this.origin[0],l[n[1]+""]=this.origin[1],l[n[4]+""]=this.len[0]/2,l[n[5]+""]=function(t){return a?-i.fontSize:u.len[1](t.value)+i.fontSize},l["font-size"]=i.fontSize,l["text-anchor"]=a?"middle":"start",l["dominant-baseline"]="central",l)),o.text(function(t){return i.showLabel?t.value:""}),d=this.axisGroup,d.attr({transform:function(){return a?"translate("+u.dim[0][0]+","+u.dim[1][0]+")":"translate("+u.dim[1][0]+","+u.dim[0][1]+")"}}),i.valueAxis&&d.call(this.axisFunc),d}})};