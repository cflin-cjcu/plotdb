var plotdomain,sched;plotdomain="http://localhost/",sched={timeout:{list:[],func:window.setTimeout,set:function(e,t){return this.func.call(null,e,t)}},interval:{list:[],func:window.setInterval,set:function(e,t){return this.func.call(null,e,t)}},clear:function(){var e,t,n,o,r=[];for(e=0,n=(t=this.timeout.list).length;n>e;++e)o=t[e],clearTimeout(o);for(e=0,n=(t=this.interval.list).length;n>e;++e)o=t[e],r.push(clearInterval(o));return r}},window.setTimeout=function(e,t){var n;return n=sched.timeout.set(e,t),sched.timeout.list.push(n),n},window.setInterval=function(e,t){var n;return n=sched.interval.set(e,t),sched.interval.list.push(n),n},window.addEventListener("click",function(){return window.parent.postMessage({type:"click",payload:""},plotdomain)}),$(document).ready(function(){var e,t,n,o,r,a;return e=function(e){return"snapshot"===e.data.type?r():"render"===e.data.type?a(e.data.payload,e.data.rebind):"parse"===e.data.type?o(e.data.payload):void 0},window.addEventListener("error",function(e){var t,o;return t=e.error.stack,t.indexOf(window.codeURL)&&(t=t.split(window.codeURL).join("line "),o=e.message+" at line "+(e.lineno-1)+".",e.message.indexOf(t)<0&&(o+=" Callstack: \n"+t)),n(window.errorMessage=o)}),t=function(e,t){return null==t&&(t=!0),new Promise(function(n){var o,r,a;return window.errorMessage="",o=t?"module":"moduleLocal",e="(function() { "+e+"; window."+o+" = module; })();",window.codeURL=r=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),a=document.createElement("script"),a.onload=function(){var e;URL.revokeObjectURL(r),n(window[o]);try{return document.body.removeChild(a)}catch(t){return e=t}},a.src=r,document.body.appendChild(a)})},n=function(e){var t,n;return t=e?typeof e!=typeof{}?e+"":e.stack?e.stack:e.toString():"plot failed with unknown error",t.length>1024&&(t=t.substring(0,1024)+"..."),n=t.split("\n"),n.length>4&&(t=n.splice(0,4).join("\n")),window.parent.postMessage({type:"error",payload:t},plotdomain)},o=function(e){var o;try{return t(e,!1).then(function(e){var t,n,o;return t=e.exports,n=JSON.stringify((o={},o.dimension=t.dimension,o.config=t.config,o)),window.parent.postMessage({type:"parse",payload:n},plotdomain)})}catch(r){return o=r,n(o)}},r=function(){var e,t,n,o,r,a;return d3.selectAll("#container svg").each(function(){var e,t,n;return e=this.getBoundingClientRect(),t=e.width,n=e.height,d3.select(this).attr({xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:t,height:n})}),e=document.querySelector("#container svg"),t=e.getBoundingClientRect(),n=t.width,o=t.height,r=document.querySelector("#container svg").outerHTML,a=new Image,a.onload=function(){var e,t;return t=document.createElement("canvas"),t.width=n,t.height=o,e=t,e.getContext("2d").drawImage(a,0,0),window.parent.postMessage({type:"snapshot",payload:e.toDataURL()},plotdomain)},a.src="data:image/svg+xml;base64,"+btoa(r)},a=function(e,o){var r,a,i,s,d,l,c,u;null==o&&(o=!0),r=e.code.content,a=e.style.content,i=e.doc.content,s=e.data,d=e.assets,l=e.config||{},sched.clear();try{return o?($(document.body).html("<style type='text/css'>"+a+"</style><div id='container'>"+i+"</div>"),c=t(r)):c=Promise.resolve(),c.then(function(){var e,t,n,r,a,i,c,u,p,w,h,g,m,f,v,y,b;e=document.getElementById("container"),t=window.module.exports;for(n in r=l)for(a=r[n],i=0,u=(c=a.type).length;u>i;++i){p=c[i],p=plotdb[p.name];try{if(p.test&&p.parse&&p.test(a.value)){a.value=p.parse(a.value);break}}catch(L){w=L,console.log("plotdb type parsing error: "+p.name),console.log(w.stack+"")}}for(n in r=t.config)a=r[n],l[n]=null==l[n]||null==l[n].value?a["default"]:l[n].value;for(t.assets=h={},i=0,u=(r=d).length;u>i;++i){for(g=r[i],m=atob(g.content),f=new Uint8Array(m.length),v=0,y=m.length;y>v;++v)b=v,f[b]=m.charCodeAt(b);g.blob=new Blob([f],{type:g.type}),g.url=URL.createObjectURL(g.blob),g.datauri=["data:",g.type,";base64,",g.content].join(""),h[g.name]=g}return o&&(t.init&&t.init(e,s,l),t.bind(e,s,l)),t.resize(e,s,l),t.render(e,s,l),window.parent.postMessage({type:"error",payload:window.errorMessage||""},plotdomain)})["catch"](function(e){return n(e)})}catch(p){return u=p,n(u)}},window.addEventListener("message",e,!1),window.addEventListener("keydown",function(e){return!e.metaKey&&!e.altKey||13!==e.keyCode&&13!==e.which?void 0:window.parent.postMessage({type:"alt-enter"},plotdomain)}),window.parent.postMessage({type:"loaded"},plotdomain)});