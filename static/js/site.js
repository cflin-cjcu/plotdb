function import$(e,t){var n={}.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}var x$;x$=angular.module("plotDB"),x$.service("eventBus",["$rootScope"].concat(function(){var e;return e=import$(this,{queues:{},handlers:{},process:function(e){var t,n,r,o,a,i,s,u,l,c,h,d,p=[];null==e&&(e=null);for(t in n=this.queues){if(r=n[t],o=[],r.length)for(a=0,s=(i=this.handlers[t]||[]).length;s>a;++a){for(u=i[a],l=[],c=0,h=r.length;h>c;++c)d=r[c],l.push(u(d));o.push(l)}p.push(o)}return p},listen:function(e,t){var n;return((n=this.handlers)[e]||(n[e]=[])).push(t),this.process(e)},fire:function(e,t){var n;return((n=this.queues)[e]||(n[e]=[])).push(t),this.process(e)}})})),x$.service("plNotify",["$rootScope","$timeout"].concat(function(e,t){return import$(this,{queue:[],send:function(e,n){var r,o=this;return this.queue.push(r={type:e,message:n}),t(function(){return o.queue.splice(o.queue.indexOf(r),1)},2900)}})})),x$.controller("plSite",["$scope","$http","$interval","global","plNotify","dataService"].concat(function(e,t,n,r,o,a){var i,s,u,l,c,h,d;for(e.trackEvent=function(e,t,n,r){return ga("send","event",e,t,n,r)},e.notifications=o.queue,e.nexturl=(i=/nexturl=([^&]+)/.exec(window.location.search||""))?i[1]:window.location.href,e.user={data:r.user},e.dataService=a,e.auth={email:"",passwd:"",show:!1,stick:!1,failed:"",keyHandler:function(e){return 13===e.keyCode?this.login():void 0},logout:function(){return console.log("logout.."),t({url:"/u/logout",method:"GET"}).success(function(){return console.log("logouted."),e.user.data=null,window.location.reload()}).error(function(){return o.send("danger","Failed to Logout. ")})},login:function(){var n=this;return t({url:"/u/login",method:"POST",data:$.param({email:this.email,passwd:this.passwd}),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(t){return e.auth.failed="",e.user.data=t,"undefined"!=typeof ga&&null!==ga&&ga("set","&uid",t.key),n.show=!1,e.nexturl?window.location.href=e.nexturl:"/u/login"===window.location.pathname?window.location.href="/":window.location.reload()}).error(function(t,n){return e.auth.failed=403===n?(t.message||(t.message=[])).length?t.message[0]:"email or password incorrect":"system error, please try later"}),this.passwd=""}},e.$watch("auth.show",function(e){return setTimeout(function(){return $("#authpanel").modal(e?"show":"hide")},0)}),window.addEventListener("scroll",function(){var e;return e=$(window).scrollTop(),60>e?$("#nav-top").removeClass("dim"):$("#nav-top").addClass("dim")}),e.charts=[],s=JSON.parse(localStorage.getItem("/list/charttype")),u=0,l=s.length;l>u;++u)c=s[u],h=JSON.parse(localStorage.getItem("/charttype/"+c)),e.charts.push(h);if(e.charts.length<10)for(u=0;40>u;++u)d=u,e.charts.push(import$({},h));return e.load=function(e){return window.location.href="/chart/?k="+((e.type||(e.type={})).name||"local")+"|charttype|"+e.key}}));