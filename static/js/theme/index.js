function import$(e,t){var n={}.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}function in$(e,t){for(var n=-1,r=t.length>>>0;++n<r;)if(e===t[n])return!0;return!1}var x$;x$=angular.module("plotDB"),x$.service("sampleTheme",["$rootScope"].concat(function(){return plotdb.theme.sample})),x$.service("themeService",["$rootScope","$http","IOService","sampleTheme","baseService","plUtil","plNotify","eventBus"].concat(function(e,t,n,r,i){var o,a,s;return o={sample:r,link:function(e){return"/theme/?k="+e.type.location.charAt(0)+e.key},thumblink:function(e){return"/theme/thumb/?k="+e.type.location.charAt(0)+e.key},sharelink:function(e){return"https://plotdb.com"+this.link(e)}},a=function(e){var t;return import$(this,{name:"untitled",description:null,tags:null,theme:null,doc:{name:"document",type:"html",content:((t=o.sample[0]).doc||(t.doc={})).content||""},style:{name:"stylesheet",type:"css",content:((t=o.sample[0]).style||(t.style={})).content||""},code:{name:"code",type:"javascript",content:((t=o.sample[0]).code||(t.code={})).content||""},config:{},dimension:{},assets:[],likes:0,parent:null}),import$(this,e),Array.isArray(this.assets)||(this.assets=[]),this},a.prototype={addFile:function(e,t,n){var r;return null==n&&(n=null),r={name:e,type:t,content:n},this.assets.push(r),r},removeFile:function(e){var t;return t=this.assets.indexOf(e),0>t?void 0:this.assets.splice(t,1)}},s=i.derive("theme",o,a)})),x$.controller("themeEditor",["$scope","$http","$timeout","$interval","dataService","chartService","paletteService","themeService","plNotify"].concat(function(e,t,n,r,i,o,a,s,c){return import$(e,{theme:new s.theme,chart:null,showsrc:!0,vis:"preview",lastvis:null,plotdomain:"http://localhost/",error:{msg:null,lineno:0},codemirror:{code:{lineWrapping:!0,lineNumbers:!0,viewportMargin:1/0,mode:"javascript"},style:{lineWrapping:!0,lineNumbers:!0,viewportMargin:1/0,mode:"css"},doc:{lineWrapping:!0,lineNumbers:!0,viewportMargin:1/0,mode:"xml"},objs:[]},canvas:{node:document.getElementById("chart-renderer"),window:document.getElementById("chart-renderer").contentWindow}}),import$(e,{_save:function(t){var r,i,o;return null==t&&(t=!1),this.theme.owner!==e.user.data.key&&(r="server"===this.theme.type.location?this.theme.key:null,i=this.theme,i.key=null,i.owner=null,i.permission=s.theme.prototype.permission,r&&(this.theme.parent=r)),o=this.theme.key?!1:!0,this.theme.save().then(function(){return e.$apply(function(){var r;return t?c.send("warning","theme saved, but thumbnail failed to update"):c.send("success","theme saved"),r=s.link(e.theme),(o||!window.location.search)&&(window.location.href=r),e.save.handle&&n.cancel(e.save.handle),e.save.handle=null,e.backup.unguard(3e3)})})["catch"](function(t){return e.$apply(function(){return c.aux.error.io("save","theme",t),console.error("[save theme]",t),e.save.handle&&n.cancel(e.save.handle),e.save.handle=null})})},save:function(){var t=this;if(!e.user.data||!e.user.data.key)return e.auth.toggle(!0);if(!this.save.handle)return this.save.handle=n(function(){return t.save.handle=null,t._save(!0)},3e3),this.canvas.window.postMessage({type:"snapshot"},this.plotdomain)},clone:function(){var e,t;return this.theme.name=this.theme.name+" - Copy",e="server"===this.chart.type.location?this.chart.key:null,t=this.theme,t.key=null,t.owner=null,t.parent=e,t.permission=o.chart.prototype.permission,this.save()},load:function(t,n){var r=this;return s.load(t,n).then(function(t){return r.theme=new s.theme(import$(r.theme,t)),r.backup.check(),e.backup.unguard(3e3),e.countline()})["catch"](function(e){return console.error(e),c.send("error","failed to load theme. please try reloading"),window.location.href=window.location.pathname})},"delete":function(){var e=this;if(this.theme.key)return this["delete"].handle=!0,this.theme["delete"]().then(function(){return c.send("success","theme deleted"),e.theme=new s.theme,setTimeout(function(){return window.location.href="/theme/me.html"},1e3),e["delete"].handle=!1})["catch"](function(){return c.send("error","failed to delete theme"),e["delete"].handle=!1})},resetConfig:function(){var e,t,n,r=[];if(this.chart){for(e in t=this.chart.config)n=t[e],r.push(n.value=n["default"]);return r}},migrate:function(){var t,n=this;if(this.theme.key)return t=this.theme.clone(),t.type.location="local"===this.theme.type.location?"server":"local",t.save().then(function(){return n.theme["delete"]().then(function(){return e.theme=t,window.location.href=s.link(e.theme)})})},reset:function(){return this.render()},render:function(t){var n,r,i,o;if(null==t&&(t=!0),this.chart){this.chart.updateData();for(n in r=this.chart)i=r[n],"function"!=typeof i&&(this.chart[n]=i);for(n in r=this.theme)i=r[n],"function"!=typeof i&&(this.theme[n]=i);return o=JSON.parse(angular.toJson({theme:this.theme,chart:this.chart})),r=e.render,r.payload=o,r.rebind=t,t?this.canvas.window.postMessage({type:"reload"},this.plotdomain):this.canvas.window.postMessage({type:"render",payload:o,rebind:t},this.plotdomain)}},renderAsync:function(e){var t=this;return null==e&&(e=!0),this.chart?(this.renderAsync.handler&&n.cancel(this.renderAsync.handler),this.renderAsync.handler=n(function(){return t.renderAsync.handler=null,t.render(e)},500)):void 0},countline:function(){var e=this;return["code","style","doc"].map(function(t){return e.theme[t].lines=e.theme[t].content.split("\n").length,e.theme[t].size=e.theme[t].content.length})},download:{prepare:function(){var t=this;return["plotdb"].map(function(n){return setTimeout(function(){return e.$apply(function(){return[t[n].url="",t[n]()]})},300)})},plotdb:function(){var t;return t=angular.toJson(e.theme),this.plotdb.url=URL.createObjectURL(new Blob([t],{type:"application/json"})),this.plotdb.size=t.length}},colorblind:function(t){var n;return n=["normal","protanopia","protanomaly","deuteranopia","deuteranomaly","tritanopia","tritanomaly","achromatopsia","achromatomaly"],in$(t,n)?this.canvas.window.postMessage({type:"colorblind-emu",payload:t},e.plotdomain):void 0},applyTheme:function(){var e,t,n,r;if(this.chart&&this.theme){for(e in t=this.chart.config)n=t[e],n._bytheme&&delete this.chart.config[e];for(e in t=this.chart.config)n=t[e],this.chart.config[e].hint&&(r=this.theme.typedef[this.chart.config[e].type[0].name],r&&null!=r[this.chart.config[e].hint]&&(this.chart.config[e].value=r[this.chart.config[e].hint]));for(e in t=this.theme.config)if(n=t[e],this.chart.config[e]){if(this.chart.config[e].type[0].name!==n.type[0].name)continue;this.chart.config[e].value=n["default"]}else this.chart.config[e]=import$({_bytheme:!0},n)}return this.theme?this.paledit.fromTheme(this.theme):void 0}}),import$(e,{backup:{enabled:!1,guard:!1,unguard:function(t){var r=this;return this.guard=!1,n(function(){var t;return r.guard=!0,t=e.unsaved,delete e.unsaved,t},t)},init:function(){var t=this;return e.$watch("theme",function(){return e.unsaved=!0,t.enabled?(t.handle&&n.cancel(t.handle),t.handle=n(function(){return t.handle=null,e.theme.backup().then(function(){})},2e3)):void 0},!0),this.unguard(3e3),window.onbeforeunload=function(){return t.guard&&e.unsaved?"You have unsaved changes. Still wanna leave?":null}},recover:function(){var t=this;if(this.last&&this.last.object)return e.theme.recover(this.last.object),this.enabled=!1,e.theme.cleanBackups().then(function(){return e.$apply(function(){return t.check()})})},check:function(){var t=this;return e.theme.backups().then(function(r){return e.$apply(function(){return t.list=r,t.last=r[0],n(function(){return t.enabled=!0},4e3)})["catch"](function(e){return console.error("fecth backup failed: #",e)})})}},charts:{list:o.sample.map(function(e){return new o.chart(e)}),set:function(t){return e.chart=t,t?o.load(t.type,t.key).then(function(t){return e.chart=new o.chart(t),e.chart.theme=e.theme,e.resetConfig(),e.render(),e.canvas.window.postMessage({type:"parse-theme",payload:e.theme.code.content},e.plotdomain)})["catch"](function(e){return console.error(e),c.send("error","failed to load chart. please try reloading")}):void 0},init:function(){var t=this;return o.list().then(function(n){return e.$apply(function(){return t.list=o.sample.map(function(e){return new o.chart(e)}).concat(n)})})}},editor:{"class":"",focus:function(){return setTimeout(function(){return e.codemirror.objs.map(function(t){var n,r,i;return n=function(){var t,n=[];for(r in t=e.codemirror)i=t[r],n.push([r,i]);return n}().filter(function(e){return e[1].mode===t.options.mode})[0],n&&e.vis.startsWith(n[0])&&(setTimeout(function(){return t.focus()},10),!n[1].refreshed)?(t.refresh(),n[1].refreshed=!0,setTimeout(function(){return t.refresh(),e.error.lineno?$("#code-editor-code .CodeMirror-code > div:nth-of-type("+e.error.lineno+")").addClass("error"):void 0},0)):void 0})},0)},update:function(){return this["class"]=[this.fullscreen.toggled?"fullscreen":"","preview"!==this.vis?"active":"",this.color.modes[this.color.idx]].join(" ")},fullscreen:{toggle:function(){return this.toggled=!this.toggled,e.editor.update(),e.editor.focus()},toggled:!1},color:{modes:["normal","dark"],idx:0,toggle:function(){return this.idx=(this.idx+1)%this.modes.length,e.editor.update()}}},settingPanel:{toggle:function(){return this.toggled=!this.toggled},toggled:!1},sharePanel:{social:{facebook:null},isForkable:function(){var t,n,r;return t=(n=e.theme.permission).value||(n.value=[]),r=!!t.filter(function(e){return"fork"===e.perm&&"public"===e["switch"]}).length},init:function(){var t=this;return["#themeedit-sharelink","#themeedit-embedcode"].map(function(n){var r;return r=new Clipboard(n),r.on("success",function(){return $(n).tooltip({title:"copied",trigger:"click"}).tooltip("show"),setTimeout(function(){return $(n).tooltip("hide")},1e3)}),r.on("error",function(){return $(n).tooltip({title:"Press Ctrl+C to Copy",trigger:"click"}).tooltip("show"),setTimeout(function(){return $(n).tooltip("hide")},1e3)}),e.$watch("sharePanel.link",function(n){var r,i,o,a,c,l,u;return t.embedcode='<iframe src="'+n+'"><iframe>',t.thumblink=s.thumblink(e.theme),r={app_id:"1546734828988373",display:"popup",caption:e.theme.name,picture:t.thumblink,link:t.link,name:e.theme.name,redirect_uri:"http://plotdb.com/",description:e.theme.desc||""},t.social.facebook=["https://www.facebook.com/dialog/feed?"].concat(function(){var e,t=[];for(i in e=r)o=e[i],t.push(i+"="+encodeURIComponent(o));return t}()).join("&"),a={url:t.link,media:t.thumblink,description:e.theme.desc||""},t.social.pinterest=["https://www.pinterest.com/pin/create/button/?"].concat(function(){var e,t=[];for(i in e=a)o=e[i],t.push(i+"="+encodeURIComponent(o));return t}()).join("&"),c={subject:"plotdb: "+e.theme.name,body:e.theme.desc+" : "+t.link},t.social.email=["mailto:?"].concat(function(){var e,t=[];for(i in e=c)o=e[i],t.push(i+"="+encodeURIComponent(o));return t}()).join("&"),l={mini:!0,url:t.link,title:e.theme.name+" on PlotDB",summary:e.theme.desc,source:"plotdb.com"},t.social.linkedin=["http://www.linkedin.com/shareArticle?"].concat(function(){var e,t=[];for(i in e=l)o=e[i],t.push(i+"="+encodeURIComponent(o));return t}()).join("&"),u={url:t.link,text:e.theme.name+" - "+(e.theme.desc||""),hashtags:"dataviz,chart,visualization",via:"plotdb"},t.social.twitter=["http://twitter.com/intent/tweet?"].concat(function(){var e,t=[];for(i in e=u)o=e[i],t.push(i+"="+encodeURIComponent(o));return t}()).join("&")}),e.$watch("sharePanel.forkable",function(n){var r;return r=t.isForkable(),r!==t.forkable&&null!=t.forkable?(e.theme.permission.value=n?[{"switch":"public",perm:"fork"}]:[],t.saveHint=!0):void 0}),e.$watch("theme.permission.value",function(){var e;return e=t.isForkable(),t.forkable!==e&&null!=t.forkable&&(t.saveHint=!0),t.forkable=e},!0)})},saveHint:!1,embedcode:"",link:"",toggle:function(){return this.init&&this.init(),this.init=null,this.toggled=!this.toggled,this.saveHint=!1},toggled:!1,isPublic:function(){return in$("public",e.theme.permission["switch"])},setPrivate:function(){var t;return((t=e.theme).permission||(t.permission={}))["switch"]=["private"],this.saveHint=!0},setPublic:function(){var t;return((t=e.theme).permission||(t.permission={}))["switch"]=["public"],this.saveHint=!0}},coloredit:{config:function(e,t){return{"class":"no-palette text-input",context:"context"+t,exclusive:!0,palette:[e.value]}}},paledit:{convert:function(e){return e.map(function(e){return{id:e.key||Math.random()+"",text:e.name,data:e.colors}})},ldcp:null,item:null,fromTheme:function(e){var t,n,r;return e&&e.config&&e.config.palette?(t=this.list.filter(function(e){return"Theme"===e.text})[0],t||(t={text:"Theme",id:"456",children:null},this.list=[t].concat(this.list)),t.children=this.convert(function(){var t,i=[];for(n in t=e.config.palette)r=t[n],i.push((r.name=n,r));return i}()),$("#pal-select option").remove(),$("#pal-select optgroup").remove(),$("#pal-select").select2({allowedMethods:["updateResults"],templateResult:function(e){var t,n;return e.data?(t=function(){var t,r,i,o=[];for(t=0,i=(r=e.data).length;i>t;++t)n=r[t],o.push("<div class='color' "+("style='background:"+n.hex+";width:"+100/e.data.length+"%'")+"></div>");return o}().join(""),$("<div class='palette select'><div class='name'>"+e.text+"</div>"+("<div class='palette-color'>"+t+"</div></div>"))):e.text},data:this.list})):this.list=this.list.filter(function(e){return"Theme"!==e.text})},init:function(){var t,n,r=this;return this.ldcp=new ldColorPicker(null,{},$("#palette-editor .editor .ldColorPicker")[0]),this.ldcp.on("change-palette",function(){return setTimeout(function(){return e.$apply(function(){return r.update()})},0)}),this.list=[{text:"Default",id:"default",children:this.convert(a.sample)}],t=$("#pal-select"),t.select2(n={allowedMethods:["updateResults"],templateResult:function(e){var t,n;return e.data?(t=function(){var t,r,i,o=[];for(t=0,i=(r=e.data).length;i>t;++t)n=r[t],o.push("<div class='color' "+("style='background:"+n.hex+";width:"+100/e.data.length+"%'")+"></div>");return o}().join(""),$("<div class='palette select'><div class='name'>"+e.text+"</div>"+("<div class='palette-color'>"+t+"</div></div>"))):e.text},data:this.list}),t.on("select2:closing",function(t){function n(e){return e.id===$(t.target).val()}var i,o,a,s,c;for(i=0,a=(o=r.list).length;a>i&&(s=o[i],!(c=s.children.filter(n)[0]));++i);if(c)return e.$apply(function(){return r.item.value=JSON.parse(JSON.stringify({colors:c.data}))}),r.ldcp.setPalette(r.item.value)}),t},update:function(){var e,t,n,r,i,o,a,s,c,l,u,h,d,p,f;if(this.item){for(e=[this.item.value,this.ldcp.getPalette(),[]],t=e[0],n=e[1],r=e[2],i=0,o=n.colors.length;o>i;++i)for(a=i,s=n.colors[a],c=0,l=t.colors.length;l>c;++c)u=c,h=t.colors[u],h.hex===s.hex&&r.push([h,s,Math.abs(a-u)]);for(r.sort(function(e,t){return e[2]-t[2]}),i=0,d=r.length;d>i;++i)p=r[i],p[0].pair||p[1].pair||(p[0].pair=p[1],p[1].pair=p[0]);for(f=[t.colors.filter(function(e){return!e.pair}),n.colors.filter(function(e){return!e.pair})],i=0,o=Math.min(f[0].length,f[1].length);o>i;++i)a=i,f[1][a].pair=f[0][a];return t.colors=n.colors.map(function(e){var t;return e.pair?(t=e.pair,t.hex=e.hex,t):e}),t.colors.forEach(function(e){var t;return t=e.pair,delete e.pair,t})}},toggled:!1,toggle:function(){return this.toggled=!this.toggled,this.toggled?void 0:this.update()},edit:function(e){return this.item=e,this.ldcp.setPalette(e.value),this.toggled=!0}},switchPanel:function(){var t=this;return setTimeout(function(){return e.$apply(function(){var e;return e=t.vis,t.vis="preview"!==t.vis||t.lastvis&&"preview"!==t.lastvis?"preview"===t.vis?t.lastvis:"preview":"code",t.lastvis=e})},0)},hidHandler:function(){var t=this;return e.codemirrored=function(t){return e.codemirror.objs.push(t)},document.body.addEventListener("keydown",function(n){return!n.metaKey&&!n.altKey||13!==n.keyCode&&13!==n.which?void 0:e.$apply(function(){return t.switchPanel()})})},checkParam:function(){var t,n,r,i;if(window.location.search){if("?demo"===window.location.search)return e.theme.doc.content=s.sample[1].doc.content,e.theme.style.content=s.sample[1].style.content,void(e.theme.code.content=s.sample[1].code.content);if(t=/[?&]k=([sl])([^&#|?]+)/.exec(window.location.search))return n=t[2],r=["s"===t[1]?"server":"local",t[2]],i=r[0],n=r[1],e.load({name:"theme",location:i},n)}},assets:{measure:function(){return e.theme.assets.size=e.theme.assets.map(function(e){return e.content.length}).reduce(function(e,t){return e+t},0)},preview:function(e){var t,n;return this.preview.toggled=!0,t=["data:",e.type,";charset=utf-8;base64,",e.content].join(""),n=document.createElement("iframe"),$("#assets-preview .iframe")[0].innerHTML="<iframe></iframe>",$("#assets-preview .iframe iframe")[0].src=t},read:function(t){return new Promise(function(n){var r,i,o,a,s;return r=(i=/([^/]+\.?[^/.]*)$/.exec(t.name))?i[1]:"unnamed",o="unknown",a=e.theme.addFile(r,o,null),s=new FileReader,s.onload=function(){var t,r,i,o,l;return t=s.result,r=t.indexOf(";"),i=t.substring(5,r),o=t.substring(r+8),l=e.theme.assets.map(function(e){return(e.content||"").length}).reduce(function(e,t){return e+t},0)+o.length,l>3e6&&e.$apply(function(){c.alert("Assets size limit (3MB) exceeded. won't upload."),e.theme.removeFile(a)}),a.type=i,a.content=o,e.$applyAsync(function(){return a.type=i,a.content=o,a}),n(a)},s.readAsDataURL(t)})},handle:function(e){var t,n,r,i=[];for(t=0,n=e.length;n>t;++t)r=e[t],i.push(this.read(r));return i},node:null,init:function(){var e,t=this;return e=this.node=$("#code-editor-assets input"),e.on("change",function(){return t.handle(t.node[0].files)}),e}},monitor:function(){var t=this;return this.assets.init(),this.$watch("vis",function(){return e.editor.focus()}),this.$watch("theme.assets",function(){return t.assets.measure()},!0),this.$watch("theme.doc.content",function(){return t.countline()}),this.$watch("theme.style.content",function(){return t.countline()}),this.$watch("theme.code.content",function(){return t.countline()}),this.$watch("theme.doc.content",function(){return t.renderAsync()}),this.$watch("theme.style.content",function(){return t.renderAsync()}),this.$watch("theme",function(){return t.renderAsync()}),this.$watch("chart",function(e){return t.renderAsync(),t.theme.chart=e?e.key:null}),this.$watch("theme.chart",function(e){return t.charts.set(t.charts.list.filter(function(t){return t.key===e})[0])}),this.$watch("theme.code.content",function(e){return t.theme?(t.communicate.parseThemeHandler&&n.cancel(t.communicate.parseThemeHandler),t.communicate.parseThemeHandler=n(function(){return t.communicate.parseThemeHandler=null,t.canvas.window.postMessage({type:"parse-theme",payload:e},t.plotdomain)},500)):void 0}),this.$watch("chart.config",function(e,n){var r,i,o;return null==n&&(n={}),r=!!function(){var t,n=[];for(i in t=e)o=t[i],n.push([i,o]);return n}().filter(function(e){var t,r;return t=e[0],r=e[1],!n[t]||r.value!==n[t].value}).map(function(){return o.rebindOnChange}).filter(function(e){return e}).length,t.renderAsync(r)},!0),this.$watch("theme.key",function(){return t.sharePanel.link=s.sharelink(t.theme)}),e.limitscroll($("#chart-configs")[0])},communicate:function(){var t=this;return window.addEventListener("message",function(n){var r;return r=n.data,e.$apply(function(){var n,i,o,a,s,c,l,u,h,d,p,f,m,v,g,y;if(r&&"object"==typeof r)if("error"===r.type){if($("#code-editor-code .CodeMirror-code > .error").removeClass("error"),e.error.msg=(r.payload||(r.payload={})).msg||"",e.error.lineno=(r.payload||(r.payload={})).lineno||0,e.error.lineno)return $("#code-editor-code .CodeMirror-code > div:nth-of-type("+e.error.lineno+")").addClass("error")}else{if("alt-enter"===r.type)return e.switchPanel();if("snapshot"===r.type)return r.payload&&(t.theme.thumbnail=r.payload),t._save();if("parse"===r.type){n=JSON.parse(r.payload),i=n.config,o=n.dimension;for(a in n=t.chart.dimension)s=n[a],null!=o[a]&&(o[a].fields=s.fields);for(a in n=t.chart.config)s=n[a],null!=i[a]&&(i[a].value=s.value);for(a in i)s=i[a],null==s.value&&(s.value=s["default"]);return n=t.chart,n.config=i,n.dimension=o,e.render()}if("parse-theme"===r.type)return n=JSON.parse(r.payload),i=n.config,c=n.typedef,n=t.theme,n.config=i,n.typedef=c,t.applyTheme(),e.render();if("loaded"===r.type){if(!t.chart)return;return e.render.payload?(l=e.render.payload,u=e.render.rebind,t.canvas.window.postMessage({type:"render",payload:l,rebind:u},t.plotdomain),e.render.payload=null):(t.canvas.window.postMessage({type:"parse",payload:t.chart.code.content},t.plotdomain),t.canvas.window.postMessage({type:"parse-theme",payload:t.theme.code.content},t.plotdomain))}if("click"===r.type)return document.dispatchEvent?(h=document.createEvent("MouseEvents"),h.initEvent("click",!0,!0),h.synthetic=!0,document.dispatchEvent(h)):(h=document.createEventObject(),h.synthetic=!0,document.fireEvent("onclick",h));if("getsvg"===r.type)return r.payload?(e.download.svg.url=URL.createObjectURL(new Blob([r.payload],{type:"image/svg+xml"})),e.download.svg.size=r.payload.length):e.download.svg.url="#";if("getpng"===r.type){if(!r.payload)return e.download.png.url="#";if(d=atob(r.payload.split(",")[1]),p=r.payload.split(",")[0].split(":")[1].split(";")[0],"image/png"!==p)return e.download.png.url="#";for(f=new ArrayBuffer(d.length),m=new Uint8Array(f),v=0,g=d.length;g>v;++v)y=v,m[y]=d.charCodeAt(y);return e.download.png.url=URL.createObjectURL(new Blob([f],{type:"image/png"})),e.download.png.size=d.length}}})},!1)},fieldAgent:{init:function(){var e=this;return $("#field-agent").on("mousewheel",function(){return e.setPosition()})},data:null,drag:{ging:!1,start:function(){return this.ging=!0},end:function(){return this.ging=!1}},setPosition:function(){var e,t,n;if(this.node)return e=this.node.getBoundingClientRect(),t=this.node.parentNode.parentNode.getBoundingClientRect(),n={left:$("#data-fields").scrollLeft(),top:$("#data-fields").scrollTop()},$("#field-agent").css({top:e.top-t.top+55-n.top+"px",left:e.left-t.left-n.left+"px",width:e.width+"px",height:e.height+"px"})},setProxy:function(e,t){var n,r,i=this;if(!this.drag.ging){for(n=[t,e.target],this.data=n[0],r=n[1];!(r.getAttribute("class").indexOf("data-field")>=0);)if(r=r.parentNode,"body"===r.nodeName.toLowerCase())return;return setTimeout(function(){return i.node=r,i.setPosition()},0)}}},init:function(){return this.communicate(),this.hidHandler(),this.monitor(),this.checkParam(),this.paledit.init(),this.backup.init(),this.fieldAgent.init(),this.charts.init()}}),e.init()})),x$.controller("themeList",["$scope","$http","IOService","dataService","themeService"].concat(function(e,t,n,r,i){return e.themes=[],Promise.all([new Promise(function(e,t){return n.aux.listLocally({name:"theme"},e,t)}),new Promise(function(e,t){return n.aux.listRemotely({name:"theme"},e,t,"q=all")})]).then(function(t){return e.$apply(function(){return e.themes=t[0].concat(t[1]),e.themes.forEach(function(e){return e.width=Math.random()>.8?640:320}),e.load=function(e){return window.location.href=i.link(e)}})})}));