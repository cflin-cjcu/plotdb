function import$(t,e){var n={}.hasOwnProperty;for(var r in e)n.call(e,r)&&(t[r]=e[r]);return t}var x$;x$=angular.module("plotDB"),x$.service("baseService",["$rootScope","IOService","eventBus"].concat(function(t,e){var n,r,i;return n={type:null,items:null,sample:[],save:function(n){var r=this;return e.save(n).then(function(e){return new Promise(function(i){return t.$applyAsync(function(){var t;return n.key=e.key,t=(r.items||(r.items=[])).map(function(t){return t.key}).indexOf(e.key),0>t?(r.items||(r.items=[])).push(n):r.items.splice(t,1,n),i(n)})})})},load:function(n,r,i){var o,s,u=this;return null==i&&(i=!1),o=function(t){return t.type.location===n.location&&t.type.name===n.name&&t.key===r},s=(this.items||(this.items=[])).filter(o)[0],s?Promise.resolve(s):e.load(n,r).then(function(e){return new Promise(function(n){return t.$applyAsync(function(){return s=u.items.filter(o)[0],s?import$(s,e):u.items.push(s=e),n(s)})})})},"delete":function(n){var r=this;return e["delete"](n.type,n.key).then(function(e){return new Promise(function(i){return t.$applyAsync(function(){var t;return t=(r.items||(r.items=[])).map(function(t){return t.key}).indexOf(n.key),t>=0&&r.items.splice(t,1),i(e)})})})},list:function(n,r,i){var o=this;return null==r&&(r={}),null==i&&(i=!1),n||(n={location:"any",name:this.type}),this.items&&!i?Promise.resolve(this.items):(this.items||(this.items=[]),e.list(n).then(function(e){return new Promise(function(n){return t.$applyAsync(function(){return o.items.splice(0,o.items.length),o.items.concat(e.map(function(t){return new o.Object(t)})).concat((o.sample||[]).map(function(t){return new o.Object(t)})),Array.prototype.splice.apply(o.items,[0,e.length+o.sample.length].concat(e.concat(o.sample).map(function(t){return new o.Object(t)}))),n(o.items)})})}))}},r=function(t){return import$(this,t)},i={wrapper:function(t){return function(e){return r.call(this,e),t.call(this,e),this}},derive:function(t,e,i){return e=import$(import$({},n),e),e.type=t,e[t]=e.Object=this.wrapper(i),r.prototype={type:{location:"server",name:t},owner:null,key:null,permission:{"switch":[],value:[]},save:function(){var t=this;return e.save(this).then(function(e){return t.key=e.key})},load:function(){var t=this;return e.load(this.type,this.key).then(function(e){return import$(t,e)})},"delete":function(){return e["delete"](this)},clone:function(){var t;return t=new e.Object(JSON.parse(JSON.stringify(this))),t.key=null,t}},import$(import$(e.Object.prototype,r.prototype),i.prototype),i.prototype=e.Object.prototype,e}}}));