$(document).ready(function(){var dispatcher,parse,snapshot,render;return dispatcher=function(e){return"snapshot"===e.data.type?snapshot():"render"===e.data.type?render(e.data.payload):"parse"===e.data.type?parse(e.data.payload):void 0},parse=function(payload){var chart,ref$;try{return eval(payload),chart=module.exports,payload=JSON.stringify((ref$={},ref$.mapping=chart.mapping,ref$.config=chart.config,ref$)),window.parent.postMessage({type:"parse",payload:payload},"http://localhost/")}catch(e$){}},snapshot=function(){var e,t,a;return e=document.createElement("canvas"),document.body.appendChild(e),t=document.getElementById("container").innerHTML,canvg(e,t),a=e.toDataURL(),window.parent.postMessage({type:"snapshot",payload:a},"http://localhost/")},render=function(payload){var code,style,doc,data,config,root,chart,k,v,i$,ref$,len$,type,e,lines;code=payload.code.content,style=payload.style.content,doc=payload.doc.content,data=payload.data,config=payload.config||{};try{$(document.body).html("<style type='text/css'>"+style+"</style><div id='container'>"+doc+"</div>"),window.module={},eval(code),root=document.getElementById("container"),chart=module.exports;for(k in config)for(v=config[k],i$=0,len$=(ref$=v.type).length;len$>i$;++i$){type=ref$[i$],type=plotdb[type.name];try{if(type.test&&type.parse&&type.test(v.value)){v.value=type.parse(v.value);break}}catch(e$){e=e$,console.log("plotdb type parsing error: "+type.name),console.log(e.stack+"")}}for(k in ref$=chart.config)v=ref$[k],config[k]=null==config[k]||null==config[k].value?v["default"]:config[k].value;return chart.init&&chart.init(root,data,config),chart.bind(root,data,config),chart.resize(root,data,config),chart.render(root,data,config),window.parent.postMessage({type:"error",payload:""},"http://localhost/")}catch(e$){return e=e$,payload=e?typeof e!=typeof{}?e+"":e.stack?e.stack:e.toString():"plot failed with unknown error",payload.length>1024&&(payload=payload.substring(0,1024)+"..."),lines=payload.split("\n"),lines.length>4&&(payload=lines.splice(0,4).join("\n")),window.parent.postMessage({type:"error",payload:payload},"http://localhost/")}},window.addEventListener("message",dispatcher,!1),window.addEventListener("keydown",function(e){return!e.metaKey&&!e.altKey||13!==e.keyCode&&13!==e.which?void 0:window.parent.postMessage({type:"alt-enter"},"http://localhost/")})});