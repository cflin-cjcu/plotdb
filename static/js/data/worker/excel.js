// Generated by LiveScript 1.3.1
var onmessage;
importScripts('/assets/js-xls/0.7.5/xlsx.full.min.js');
onmessage = function(e){
  var data, buf, workbook, sheet, list, h, k;
  data = {};
  buf = e.data;
  workbook = XLSX.read(buf, {
    type: 'binary'
  });
  sheet = workbook.Sheets[workbook.SheetNames[0]];
  list = XLSX.utils.sheet_to_json(sheet);
  data.headers = h = (function(){
    var results$ = [];
    for (k in list[0] || {}) {
      results$.push(k);
    }
    return results$;
  }());
  data.rows = list.map(function(row){
    var i$, ref$, len$, k, results$ = [];
    for (i$ = 0, len$ = (ref$ = h).length; i$ < len$; ++i$) {
      k = ref$[i$];
      results$.push(row[k]);
    }
    return results$;
  });
  console.log(data.rows);
  return postMessage(data);
};