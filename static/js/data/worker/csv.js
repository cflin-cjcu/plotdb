// Generated by LiveScript 1.3.1
var onmessage;
importScripts('/assets/papaparse/4.1.2/papaparse.min.js', '/assets/utf8js/2.0.0/utf8.js', '/js/plotdb/type.js', '/js/data/worker/grid-render.js');
onmessage = function(e){
  var result, this$ = this;
  result = [];
  return Papa.parse(e.data.buf.trim() || "", {
    worker: false,
    step: function(arg$){
      var rows, len, i$, to$, i, results$ = [];
      rows = arg$.data;
      len = result.length;
      for (i$ = 0, to$ = rows.length; i$ < to$; ++i$) {
        i = i$;
        results$.push(result[i + len] = rows[i]);
      }
      return results$;
    },
    complete: function(){
      var data, ret;
      data = {};
      data.headers = result[0] || [];
      result.splice(0, 1);
      data.rows = result;
      data.types = plotdb.Types.resolve({
        rows: data.rows,
        headers: data.headers
      });
      ret = gridRender({
        data: data
      });
      data.trs = ret.trs;
      data.ths = ret.ths;
      return postMessage({
        data: data
      });
    }
  });
};