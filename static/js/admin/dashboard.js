// Generated by LiveScript 1.3.1
var x$;
x$ = angular.module('plotDB');
x$.controller('adminDashboard', ['$scope'].concat(function($scope){
  var dataToFields;
  dataToFields = function(data, fieldNames, dimNames){
    var ret;
    ret = {};
    fieldNames.map(function(n, i){
      if (data[0] && Array.isArray(data[0][n])) {
        return ret[dimNames[i]] = data[0][n].map(function(e, j){
          return {
            name: n,
            data: data.map(function(d, i){
              return d[n][j];
            })
          };
        });
      } else {
        return ret[dimNames[i]] = [{
          name: n,
          data: data.map(function(d, i){
            return d[n];
          })
        }];
      }
    });
    return ret;
  };
  plotdb.load(953, function(chart){
    var signup2, fields;
    signup2 = signup.filter(function(it){
      return it.date;
    });
    signup2.map(function(d, i){
      return d.date = moment(d.date).format("YY/MM/DD");
    });
    fields = dataToFields(signup2, ['count', 'date'], ['value', 'order']);
    chart.config({
      margin: 30,
      nodeSize: 4,
      nodeStrokeWidth: 0
    });
    chart.data(fields);
    return chart.attach(document.getElementById('adm-user-registration'));
  });
  plotdb.load(953, function(chart){
    var newchart2, fields2;
    newchart2 = newchart.filter(function(it){
      return it.date;
    });
    newchart2.map(function(d, i){
      return d.date = moment(d.date).format("YY/MM/DD");
    });
    fields2 = dataToFields(newchart2, ['count', 'date'], ['value', 'order']);
    chart.config({
      margin: 30,
      nodeSize: 4,
      nodeStrokeWidth: 0
    });
    chart.data(fields2);
    return chart.attach(document.getElementById('adm-chart-creation'));
  });
  return plotdb.load(1073, function(chart){
    var ur, fields;
    ur = userrank.map(function(it){
      it.count = +it.count;
      return it;
    });
    fields = dataToFields(ur, ['count', 'owner'], ['value', 'order']);
    console.log(fields);
    chart.config({
      margin: 30,
      sort: "Descending"
    });
    chart.data(fields);
    return chart.attach(document.getElementById('adm-userrank'));
  });
}));